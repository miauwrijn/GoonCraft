# GoonCraft Development Makefile
# ==============================
# Run from project root: make -C dev <command>
# Or from dev folder: make <command>
#
# Commands:
#   make start   - Start the Minecraft server
#   make stop    - Stop the server
#   make build   - Build the plugin
#   make reload  - Reload the plugin
#   make dev     - Build + Reload (full dev cycle)
#   make logs    - View server logs

.PHONY: start stop build reload dev logs console clean setup help

help:
	@echo ""
	@echo "  GoonCraft Dev Commands"
	@echo "  ======================"
	@echo ""
	@echo "  make start   - Start the Minecraft server"
	@echo "  make stop    - Stop the server"
	@echo "  make build   - Build the plugin"
	@echo "  make reload  - Reload plugin on server"
	@echo "  make dev     - Build + Reload (main dev command)"
	@echo "  make logs    - View server logs"
	@echo "  make console - Attach to server console"
	@echo "  make setup   - First time setup"
	@echo ""

start:
	@echo "ğŸš€ Starting GoonCraft server..."
	@docker compose up -d minecraft
	@echo "âœ… Server starting at localhost:25565"

stop:
	@echo "ğŸ›‘ Stopping server..."
	@docker compose down
	@echo "âœ… Server stopped"

build:
	@echo "ğŸ”¨ Building plugin..."
	@docker compose run --rm build

reload:
	@echo "ğŸ”„ Reloading plugin..."
	@docker compose run --rm reload || echo "âš ï¸  Server might not be running"

dev: build reload
	@echo "âœ… Dev cycle complete!"

logs:
	@docker compose logs -f minecraft

console:
	@docker attach gooncraft-server

setup:
	@echo "ğŸ“¦ Setting up development environment..."
	@mkdir -p ../server-data/plugins
	@docker compose pull
	@$(MAKE) build
	@echo "âœ… Setup complete! Run 'make start' to start the server"

clean:
	@echo "ğŸ§¹ Cleaning..."
	@docker compose run --rm build mvn clean -q
	@echo "âœ… Clean complete"

